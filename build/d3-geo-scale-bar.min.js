!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.d3=t.d3||{})}(this,function(t){"use strict";function n(){this.reset()}function e(t,n,e){var r=t.s=n+e,o=r-n,i=r-o;t.t=n-i+(e-o)}function r(t,n){t&&x.hasOwnProperty(t.type)&&x[t.type](t,n)}function o(t,n,e){var r,o=-1,i=t.length-e;for(n.lineStart();++o<i;)r=t[o],n.point(r[0],r[1],r[2]);n.lineEnd()}function i(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)o(t[e],n,1);n.polygonEnd()}function a(t,n){t&&k.hasOwnProperty(t.type)?k[t.type](t,n):r(t,n)}function c(){P.point=l,P.lineEnd=u}function u(){P.point=P.lineEnd=function(t){}}function l(t,n){t*=Math.PI/180,n*=Math.PI/180,y=t,m=Math.sin(n),v=Math.cos(n),P.point=f}function f(t,n){t*=Math.PI/180,n*=Math.PI/180;var e=Math.sin(n),r=Math.cos(n),o=Math.abs(t-y),i=Math.cos(o),a=Math.sin(o),c=r*a,u=v*e-m*r*i,l=m*e+v*r*i;S.add(Math.atan2(Math.sqrt(c*c+u*u),l)),y=t,m=e,v=r}function s(t){return S.reset(),a(t,P),+S}function h(t,n){return C[0]=t,C[1]=n,s(b)}function d(){return 1}function p(){function t(t){o=null===o?null:o||u.charAt(0).toUpperCase()+u.slice(1);var d=i[1][0]-i[0][0],m=i[1][1]-i[0][1],v=i[0][0]+d*a,M=i[0][1]+m*c,k=n.invert([v,M]),x=0,S=0;if(e)x=e,S=x/(h(k,n.invert([v+1,M]))*l);else for(var P=.01,C=0;S<60&&C<100&&(x=P,!((S=x/(h(k,n.invert([v+1,M]))*l))>=60));)x=4*P,S=x/(h(k,n.invert([v+1,M]))*l),P*=10,C++;var b=x/g,w=null===r?[]:r||[0,b/4,b/2,b],E=function(t){return t*S/(x/g)},L=t.selection?t.selection():t,z=L.selectAll(".label").data([o]),A=L.selectAll(".domain").data([null]),O=L.selectAll(".tick").data(w,E).order(),j=O.exit(),F=O.enter().append("g").attr("class","tick"),I=O.select("line"),B=O.select("text"),_=O.select("rect");L.attr("font-family","sans-serif").attr("transform","translate(".concat([v,M],")")),A=A.merge(A.enter().insert("path",".tick").attr("class","domain").attr("fill","none").attr("stroke","currentColor")),O=O.merge(F),I=I.merge(F.append("line").attr("stroke","currentColor").attr("y2",s*y)),B=B.merge(F.append("text").attr("fill","currentColor").attr("y",s*y+2).attr("font-size",10).attr("text-anchor","middle").attr("dy","".concat(1===y?.71:-.35,"em"))),_=_.merge(F.append("rect").attr("fill",function(t,n){return n%2==0?"currentColor":"#fff"}).attr("stroke","currentColor").attr("stroke-width",.5).attr("width",function(t,n,e){return n===e.length-1?0:E(w[n+1]-t)}).attr("y",1===y?0:-s).attr("height",s)),t!==L&&(O=O.transition(t),A=A.transition(t),_=_.transition(t),j=j.transition(t).attr("opacity",1e-6).attr("transform",function(t){return"translate(".concat(E(t),")")}),F.attr("opacity",1e-6).attr("transform",function(t){return"translate(".concat(E(t),")")})),j.remove(),A.attr("d","M".concat(E(0),",").concat(s*y," L").concat(E(0),",0 L").concat(E(b),",0 L").concat(E(b),",").concat(s*y)),O.attr("transform",function(t){return"translate(".concat(E(t),")")}).attr("opacity",1),I.attr("y2",s*y),B.attr("y",s*y+2).text(f),_.attr("fill",function(t,n){return n%2==0?"currentColor":"#fff"}).attr("width",function(t,n,e){return n===e.length-1?0:E(w[n+1]-t)}).attr("y",1===y?0:-s).attr("height",s),null===z?z.remove():z.enter().append("text").attr("class","label").attr("fill","currentColor").attr("font-size",12).attr("dy","-0.32em").merge(z).attr("x","start"===p?0:E("middle"===p?b/2:b)).attr("y",1===y?0:"1.3em").attr("text-anchor",p).text(function(t){return t})}var n,e,r,o,i=null,a=0,c=0,u="kilometers",l=6371,f=function(t){return Math.round(t)},s=4,p="start",g=1,y=d(),m={miles:{radius:3959},kilometers:{radius:6371}};return t.distance=function(n){return arguments.length?(e=+n,t):e},t.extent=function(n){return arguments.length?(i=n,t):i},t.label=function(n){return arguments.length?(o=n,t):o},t.labelAnchor=function(n){return arguments.length?(p=n,t):p},t.left=function(n){return arguments.length?(a=+n>1?1:+n<0?0:+n,t):a},t.orient=function(n){return arguments.length?(y=n(),t):1===y?"bottom":"top"},t.projection=function(e){return arguments.length?(n=e,t):n},t.radius=function(n){return arguments.length?(l=+n,t):l},t.size=function(n){return arguments.length?(i=[[0,0],n],t):i[1]},t.top=function(n){return arguments.length?(c=+n>1?1:+n<0?0:+n,t):c},t.tickValues=function(n){return arguments.length?(r=n,t):r},t.tickFormat=function(n){return arguments.length?(f=n,t):f},t.tickSize=function(n){return arguments.length?(s=+n,t):s},t.units=function(n){return arguments.length?(u=n,Object.keys(m).includes(n)&&(l=m[n].radius),t):u},t.zoomFactor=function(n){return arguments.length?(g=+n,t):g},t}function g(){return-1}n.prototype={constructor:n,reset:function(){this.s=this.t=0},add:function(t){e(M,t,this.t),e(this,M.s,this.s),this.s?this.t+=M.t:this.s=M.t},valueOf:function(){return this.s}};var y,m,v,M=new n,k={Feature:function(t,n){r(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,o=-1,i=e.length;++o<i;)r(e[o].geometry,n)}},x={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){o(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,i=e.length;++r<i;)o(e[r],n,0)},Polygon:function(t,n){i(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)i(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,o=-1,i=e.length;++o<i;)r(e[o],n)}},S=function(){return new n}(),P={sphere:function(t){},point:function(t){},lineStart:c,lineEnd:function(t){},polygonStart:function(t){},polygonEnd:function(t){}},C=[null,null],b={type:"LineString",coordinates:C};t.geoScaleBar=p,t.geoScaleBottom=d,t.geoScaleTop=g,Object.defineProperty(t,"__esModule",{value:!0})});