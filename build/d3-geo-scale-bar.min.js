!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports):"function"==typeof define&&define.amd?define(["exports"],n):n(t.d3=t.d3||{})}(this,function(t){"use strict";function n(){return new e}function e(){this.reset()}function r(t,n,e){var r=t.s=n+e,o=r-n,i=r-o;t.t=n-i+(e-o)}function o(t){return t>1?it:t<-1?-it:Math.asin(t)}function i(){}function a(t,n){t&&yt.hasOwnProperty(t.type)&&yt[t.type](t,n)}function u(t,n,e){var r,o=-1,i=t.length-e;for(n.lineStart();++o<i;)r=t[o],n.point(r[0],r[1],r[2]);n.lineEnd()}function f(t,n){var e=-1,r=t.length;for(n.polygonStart();++e<r;)u(t[e],n,1);n.polygonEnd()}function l(t,n){t&&gt.hasOwnProperty(t.type)?gt[t.type](t,n):a(t,n)}function c(){mt.point=h}function s(){p(I,K)}function h(t,n){mt.point=p,I=t,K=n,t*=lt,n*=lt,A=t,D=ht(n=n/2+at),H=pt(n)}function p(t,n){t*=lt,n*=lt,n=n/2+at;var e=t-A,r=e>=0?1:-1,o=r*e,i=ht(n),a=pt(n),u=H*a,f=D*i+u*ht(o),l=u*r*pt(o);vt.add(st(l,f)),A=t,D=i,H=a}function d(t){return[st(t[1],t[0]),o(t[2])]}function g(t){var n=t[0],e=t[1],r=ht(e);return[r*ht(n),r*pt(n),pt(e)]}function y(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]}function v(t){var n=dt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=n,t[1]/=n,t[2]/=n}function S(t,n){Y.push(Z=[J=t,R=t]),n<Q&&(Q=n),n>T&&(T=n)}function m(t,n){var e=g([t*lt,n*lt]);if(X){var r=y(X,e),o=[r[1],-r[0],0],i=y(o,r);v(i),i=d(i);var a,u=t-U,f=u>0?1:-1,l=i[0]*ft*f,c=ct(u)>180;c^(f*U<l&&l<f*t)?(a=i[1]*ft)>T&&(T=a):(l=(l+360)%360-180,c^(f*U<l&&l<f*t)?(a=-i[1]*ft)<Q&&(Q=a):(n<Q&&(Q=n),n>T&&(T=n))),c?t<U?P(J,t)>P(J,R)&&(R=t):P(t,R)>P(J,R)&&(J=t):R>=J?(t<J&&(J=t),t>R&&(R=t)):t>U?P(J,t)>P(J,R)&&(R=t):P(t,R)>P(J,R)&&(J=t)}else Y.push(Z=[J=t,R=t]);n<Q&&(Q=n),n>T&&(T=n),X=e,U=t}function M(){Et.point=m}function E(){Z[0]=J,Z[1]=R,Et.point=S,X=null}function x(t,n){if(X){var e=t-U;Mt.add(ct(e)>180?e+(e>0?360:-360):e)}else V=t,W=n;mt.point(t,n),m(t,n)}function N(){mt.lineStart()}function w(){x(V,W),mt.lineEnd(),ct(Mt)>rt&&(J=-(R=180)),Z[0]=J,Z[1]=R,X=null}function P(t,n){return(n-=t)<0?n+360:n}function b(t,n){return t[0]-n[0]}function O(t,n){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}function j(t){var n,e,r,o,i,a,u;if(T=R=-(J=Q=1/0),Y=[],l(t,Et),e=Y.length){for(Y.sort(b),n=1,r=Y[0],i=[r];n<e;++n)o=Y[n],O(r,o[0])||O(r,o[1])?(P(r[0],o[1])>P(r[0],r[1])&&(r[1]=o[1]),P(o[0],r[1])>P(r[0],r[1])&&(r[0]=o[0])):i.push(r=o);for(a=-1/0,e=i.length-1,n=0,r=i[e];n<=e;r=o,++n)o=i[n],(u=P(r[1],o[0]))>a&&(a=u,J=o[0],R=r[1])}return Y=Z=null,J===1/0||Q===1/0?[[NaN,NaN],[NaN,NaN]]:[[J,Q],[R,T]]}function k(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function z(t){return function(n,e){return k(t(n),e)}}function L(){Nt.point=C,Nt.lineEnd=B}function B(){Nt.point=Nt.lineEnd=i}function C(t,n){t*=lt,n*=lt,$=t,tt=pt(n),nt=ht(n),Nt.point=F}function F(t,n){t*=lt,n*=lt;var e=pt(n),r=ht(n),o=ct(t-$),i=ht(o),a=pt(o),u=r*a,f=nt*e-tt*r*i,l=tt*e+nt*r*i;xt.add(st(dt(u*u+f*f),l)),$=t,tt=e,nt=r}function _(t){return xt.reset(),l(t,Nt),+xt}function q(t,n){return wt[0]=t,wt[1]=n,_(Pt)}function G(){function t(t){var m=j(i),M=o([0,m[0][1]]),E=o([0,m[1][1]]),x=Math.abs(M[1]-E[1]),N=Math.abs((m[1][1]-m[0][1])*S),w=[m[0][0],N],P=[m[1][0],N],b=q(w,P),O=b*d,k=b*g,z=o(w),L=o(P),B=L[0]-z[0];h=h||Math.pow(10,n(O)-1);var C=h/O,F=C*B;p=p||Math.pow(10,n(k)-1);var _=p/k,G=_*B,I=Math.min(M[1],E[1])+x*S,K=Math.min(z[0],L[0])+B*v;t.attr("width",r[0]).attr("height",r[1]),a=a||t.append("g").attr("class","miles"),f=f||a.append("rect"),f.attr("width",F).attr("height",y).attr("transform","translate(0, 12)").attr("y",I).attr("x",K),c=c||a.append("text"),c.attr("x",K).attr("y",I-3).attr("transform","translate(0, 12)").style("font-family","sans-serif").style("font-size","12px").text(e(h)+" mile"+(1===h?"":"s")),u=u||t.append("g").attr("class","kilometers"),l=l||u.append("rect"),l.attr("width",G).attr("height",y).attr("transform","translate(0, 42)").attr("y",I).attr("x",K),s=s||u.append("text"),s.attr("x",K).attr("y",I-3).attr("transform","translate(0, 42)").style("font-family","sans-serif").style("font-size","12px").text(e(p)+" kilometer"+(1===p?"":"s"))}function n(t){return Math.floor(t).toString().length}function e(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}var r,o,i,a,u,f,l,c,s,h,p,d=3959,g=6371,y=1,v=0,S=0;return t.fitSize=function(n,e){return r=n,i=e,t},t.extent=function(n){return arguments.length?(r=n,t):r},t.feature=function(n){return arguments.length?(i=n,t):i},t.projection=function(n){return arguments.length?(o=n,t):o},t.radiusMiles=function(n){return arguments.length?(d=+n,t):d},t.radiusKilometers=function(n){return arguments.length?(g=+n,t):g},t.miles=function(n){return arguments.length?(h=+n,t):h},t.kilometers=function(n){return arguments.length?(p=+n,t):p},t.height=function(n){return arguments.length?(y=+n,t):y},t.left=function(n){return arguments.length?(v=n>1?1:n<0?0:+n,t):v},t.top=function(n){return arguments.length?(S=n>1?1:n<0?0:+n,t):S},t}e.prototype={constructor:e,reset:function(){this.s=this.t=0},add:function(t){r(et,t,this.t),r(this,et.s,this.s),this.s?this.t+=et.t:this.s=et.t},valueOf:function(){return this.s}};var I,K,A,D,H,J,Q,R,T,U,V,W,X,Y,Z,$,tt,nt,et=new e,rt=1e-6,ot=Math.PI,it=ot/2,at=ot/4,ut=2*ot,ft=180/ot,lt=ot/180,ct=Math.abs,st=Math.atan2,ht=Math.cos,pt=Math.sin,dt=Math.sqrt,gt={Feature:function(t,n){a(t.geometry,n)},FeatureCollection:function(t,n){for(var e=t.features,r=-1,o=e.length;++r<o;)a(e[r].geometry,n)}},yt={Sphere:function(t,n){n.sphere()},Point:function(t,n){t=t.coordinates,n.point(t[0],t[1],t[2])},MultiPoint:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)t=e[r],n.point(t[0],t[1],t[2])},LineString:function(t,n){u(t.coordinates,n,0)},MultiLineString:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)u(e[r],n,0)},Polygon:function(t,n){f(t.coordinates,n)},MultiPolygon:function(t,n){for(var e=t.coordinates,r=-1,o=e.length;++r<o;)f(e[r],n)},GeometryCollection:function(t,n){for(var e=t.geometries,r=-1,o=e.length;++r<o;)a(e[r],n)}},vt=n(),St=n(),mt={point:i,lineStart:i,lineEnd:i,polygonStart:function(){vt.reset(),mt.lineStart=c,mt.lineEnd=s},polygonEnd:function(){var t=+vt;St.add(t<0?ut+t:t),this.lineStart=this.lineEnd=this.point=i},sphere:function(){St.add(ut)}},Mt=n(),Et={point:S,lineStart:M,lineEnd:E,polygonStart:function(){Et.point=x,Et.lineStart=N,Et.lineEnd=w,Mt.reset(),mt.polygonStart()},polygonEnd:function(){mt.polygonEnd(),Et.point=S,Et.lineStart=M,Et.lineEnd=E,vt<0?(J=-(R=180),Q=-(T=90)):Mt>rt?T=90:Mt<-rt&&(Q=-90),Z[0]=J,Z[1]=R}},xt=(n(),function(t){1===t.length&&(t=z(t))}(k),n()),Nt={sphere:i,point:i,lineStart:L,lineEnd:i,polygonStart:i,polygonEnd:i},wt=[null,null],Pt={type:"LineString",coordinates:wt};n(),n(),n();t.geoScaleBar=G,Object.defineProperty(t,"__esModule",{value:!0})});